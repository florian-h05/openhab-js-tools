<!DOCTYPE html>
<html lang="en">
<head>
    
    <meta charset="utf-8">
    <title>Home - Documentation</title>
    
    
    <script src="scripts/prettify/prettify.js"></script>
    <script src="scripts/prettify/lang-css.js"></script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <link type="text/css" rel="stylesheet" href="styles/prettify.css">
    <link type="text/css" rel="stylesheet" href="styles/jsdoc.css">
    <script src="scripts/nav.js" defer></script>
    
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
</head>
<body>

<input type="checkbox" id="nav-trigger" class="nav-trigger" />
<label for="nav-trigger" class="navicon-button x">
  <div class="navicon"></div>
</label>

<label for="nav-trigger" class="overlay"></label>

<nav >
    
    <input type="text" id="nav-search" placeholder="Search" />
    
    
    <h2><a href="index.html">Home</a></h2><h3>Namespaces</h3><ul><li><a href="itemutils.html">itemutils</a><ul class='methods'><li data-type='method'><a href="itemutils.html#.dimItem">dimItem</a></li><li data-type='method'><a href="itemutils.html#.getGroupUtils">getGroupUtils</a></li><li data-type='method'><a href="itemutils.html#.getRoofwindowOpenLevel">getRoofwindowOpenLevel</a></li></ul></li><li><a href="rulesx.html">rulesx</a><ul class='methods'><li data-type='method'><a href="rulesx.html#.createAlarmClock">createAlarmClock</a></li><li data-type='method'><a href="rulesx.html#.createAlarmClockItems">createAlarmClockItems</a></li><li data-type='method'><a href="rulesx.html#.createSceneEngine">createSceneEngine</a></li></ul></li><li><a href="rulesx.alerting.html">alerting</a><ul class='methods'><li data-type='method'><a href="rulesx.alerting.html#.createFrostAlarmRule">createFrostAlarmRule</a></li><li data-type='method'><a href="rulesx.alerting.html#.createHeatAlarmRule">createHeatAlarmRule</a></li><li data-type='method'><a href="rulesx.alerting.html#.createRainAlarmRule">createRainAlarmRule</a></li></ul></li><li><a href="thingsx.html">thingsx</a><ul class='methods'><li data-type='method'><a href="thingsx.html#.createReEnableThingWithItemRule">createReEnableThingWithItemRule</a></li><li data-type='method'><a href="thingsx.html#.createThingStatusRule">createThingStatusRule</a></li><li data-type='method'><a href="thingsx.html#.reEnableThing">reEnableThing</a></li></ul></li></ul><h3>Classes</h3><ul><li><a href="itemutils.GroupUtils.html">GroupUtils</a><ul class='methods'><li data-type='method'><a href="itemutils.GroupUtils.html#descendentsCount">descendentsCount</a></li><li data-type='method'><a href="itemutils.GroupUtils.html#membersCount">membersCount</a></li></ul></li><li><a href="rulesx.SceneEngine.html">SceneEngine</a></li><li><a href="rulesx.alerting.HeatFrostalarm.html">HeatFrostalarm</a></li><li><a href="rulesx.alerting.Rainalarm.html">Rainalarm</a></li><li><a href="thingsx.MlscRestClient.html">MlscRestClient</a><ul class='methods'><li data-type='method'><a href="thingsx.MlscRestClient.html#createCommandHandlingRule">createCommandHandlingRule</a></li><li data-type='method'><a href="thingsx.MlscRestClient.html#scheduleStateFetching">scheduleStateFetching</a></li></ul></li></ul>
    
</nav>

<div id="main">
    

    



    


    <section class="package">
        <h3>@hotzware/openhab-tools 3.0.0</h3>		
    </section>









    



    <section class="readme usertext">
        <article><h1>openHAB JS Automation Tools</h1>
<p>This library provides some utilites for the openHAB JS Scripting Add-On.</p>
<p>Please note that it depends on the <a href="https://github.com/openhab/openhab-js">openHAB JavaScript Library</a>, which is included in the JS Scripting Add-On by default.
Therefore, it is only listed in the devDependencies of this package.</p>
<p><a href="https://github.com/standard/semistandard"><img src="https://img.shields.io/badge/code%20style-semistandard-brightgreen.svg" alt="js-semistandard-style"></a>
<a href="https://badge.fury.io/js/@hotzware%2Fopenhab-tools"><img src="https://badge.fury.io/js/@hotzware%2Fopenhab-tools.svg" alt="npm version"></a></p>
<h2>Installation</h2>
<ul>
<li>Requires the openHAB <a href="https://www.openhab.org/addons/automation/jsscripting/">JavaScript binding</a> which comes with a version of the <a href="https://www.npmjs.com/package/openhab">openHAB
library</a>.</li>
<li>Go to the javascript user scripts directory: <code>cd $OPENHAB_CONF/automation/js</code></li>
<li>Run <code>npm install @hotzware/openhab-tools</code> (you may need to install npm)</li>
</ul>
<h2>Compatibility</h2>
<p>This library depends on <code>openhab</code> &gt;= 4.6.0 (which is included since openHAB 4.1.0 Milestone 2) and <code>openhab_rules_tools</code> &gt;= 2.0.1.</p>
<p><code>openhab_rules_tools</code> will automatically get installed by npm, <code>openhab</code> is already included with the add-on.
Just make sure you have a compatible version installed (use <code>console.log(utils.OPENHAB_JS_VERSION)</code> to check the currently used version).</p>
<h2>API</h2>
<p>To have a look at all capabilities of this library, have a look at the <a href="https://florian-h05.github.io/openhab-js-tools/index.html">JSDoc()</a>.</p>
<p>The README will only take care of the most important stuff, and explain the more complicated ones.</p>
<h3><code>itemutils</code></h3>
<ul>
<li><code>dimItem</code>: Dims an Item step-by-step to a target state.</li>
<li><code>getGroupUtils</code>: See <a href="#group-utilities">Group Utilities</a></li>
</ul>
<h4>Group Utilities</h4>
<p>The Group Utilities provide a number of functions on groups, e.g. arithmetic operations like min/max and count operations.</p>
<h5>Examples</h5>
<pre class="prettyprint source lang-javascript"><code>const { itemutils } = require('@hotzware/openhab-tools');
// The name of the member with the maximum state.
itemutils.getGroupUtils(group).membersMax.name;
// The sum of states.
itemutils.getGroupUtils(group).membersSum;
// Count how many members are on.
itemutils.getGroupUtils(group).membersCount(item => item.state === 'ON');
</code></pre>
<p>See <a href="https://florian-h05.github.io/openhab-js-tools/itemutils.GroupUtils.html">JSDoc: GroupUtils</a> for full API documentation.</p>
<h3><code>rulesx</code></h3>
<ul>
<li><code>createAlarmClock</code>: See <a href="#alarm-clock">Alarm Clock</a>.</li>
<li><code>createAlarmClockItems</code>: Creates the required Items for an alarm clock and optionally also generates Sitemap code.</li>
<li><code>createSceneEngine</code>: See <a href="#scene-engine">Scene Engine</a>.</li>
</ul>
<h4>Alarm Clock</h4>
<p>Creates an alarm clock with time and days configurable over Items, therefore compatible with Sitemaps.</p>
<p>Under the hood, two rules are created.
The first rule, the so-called manager rule, watches for configuration changes and updates the cron trigger of the second rule, the alarm clock itself.
It also disables and enables the alarm clock rule based on the <em>switchItem</em>.</p>
<h5>Required Items</h5>
<p>Configuration Items must follow a specific naming scheme, <em>switchItem</em> can be anything.</p>
<table>
<thead>
<tr>
<th>Itemname-Suffix</th>
<th>Purpose</th>
</tr>
</thead>
<tbody>
<tr>
<td><em>switchItem</em></td>
<td>Enable/disable alarm</td>
</tr>
<tr>
<td><em>switchItem</em><code>_H</code></td>
<td>Hour</td>
</tr>
<tr>
<td><em>switchItem</em><code>_M</code></td>
<td>Minute</td>
</tr>
<tr>
<td><em>switchItem</em><code>_MON</code></td>
<td>Monday</td>
</tr>
<tr>
<td><em>switchItem</em><code>_TUE</code></td>
<td>Tuesday</td>
</tr>
<tr>
<td><em>switchItem</em><code>_WED</code></td>
<td>Wednesday</td>
</tr>
<tr>
<td><em>switchItem</em><code>_THU</code></td>
<td>Thursday</td>
</tr>
<tr>
<td><em>switchItem</em><code>_FRI</code></td>
<td>Friday</td>
</tr>
<tr>
<td><em>switchItem</em><code>_SAT</code></td>
<td>Saturday</td>
</tr>
<tr>
<td><em>switchItem</em><code>_SUN</code></td>
<td>Sunday</td>
</tr>
<tr>
<td><em>switchItem</em><code>_Time</code></td>
<td>Displays the alarm time as String.</td>
</tr>
</tbody>
</table>
<h5>Alarm Rule</h5>
<pre class="prettyprint source lang-javascript"><code>rulesx.createAlarmClock(switchItem, data => { console.log('Successfully tested alarm clock.'); });
</code></pre>
<p>See <a href="https://florian-h05.github.io/openhab-js-tools/rulesx.html#.getAlarmClock">JSDoc: getAlarmClock()</a> for full API documentation.</p>
<h4>Scene Engine</h4>
<p>Call scene by sending a command to the <code>sceneItem</code>.</p>
<p>When a member of the scene changes it's state, the rule will check whether a
defined scene is matching the current states and which scene.</p>
<p>It creates a full rule with triggers and actions out of your scene definition.</p>
<h6>The <code>sceneItem</code></h6>
<p>Must be a Number item.
You can assign a scene to every positive integer value, except to 0.</p>
<p>0 is the value the Item is et to when no match with a scene is found on members' change.</p>
<h6>Scene definition</h6>
<p>Scene definition works with an array of objects.</p>
<pre class="prettyprint source lang-javascript"><code>const sceneDefinition = {
  controller: 'scene call item name',
  scenes: [ // For each numeric state of the controller Item one object.
    { // Object for the value 1 of the controller Item.
      value: 1,
      targets: [ // Target states of items in the scene. Parameters explained later.
        { item: 'Florian_Licht', value: 'ON', required: true, conditionFn: function() { return parseFloat(items.getItem('Helligkeit').state) >= 10000; } },
        { item: 'Florian_LED_Stripes', value: 'OFF', required: false }
      ] 
    },
    { // Object for the value 15 of the controller Item.
      value: 15,
      targets: [ // Target states of items in the scene. Parameters explained later.
        { item: 'Florian_LED_Stripes', value: 'ON', required: true }
      ]
    }
  ]
};
</code></pre>
<h5>Create the Scene Engine</h5>
<pre class="prettyprint source lang-javascript"><code>rulesx.createSceneEngine(sceneDefinition);
</code></pre>
<p>See <a href="https://florian-h05.github.io/openhab-js-tools/rulesx.html#.createSceneEngine">JSDoc: createSceneEngine()</a> for full API documentation.</p>
<h3><code>thingsx</code></h3>
<ul>
<li><code>createReEnableThingWithItemRule</code>: Creates a rule that re-enabled a Thing on command ON to a given Item.</li>
<li><code>createThingStatusRule</code>: Creates a rule that posts Thing statuses to String Items.</li>
<li><code>reEnableThing</code>: Re-enables a Thing by first disabling and then enabling it again.</li>
<li><code>MlscRestClient</code>: Class providing state fetching from and command sending to <a href="https://github.com/TobKra96/music_led_strip_control">music_led_strip_control</a>.</li>
</ul></article>
    </section>






    
    
</div>

<br class="clear">

<footer>
    Documentation generated by <a href="https://github.com/jsdoc3/jsdoc">JSDoc 4.0.2</a> on Sat Oct 14 2023 21:19:07 GMT+0000 (Coordinated Universal Time) using the <a href="https://github.com/clenemt/docdash">docdash</a> theme.
</footer>

<script>prettyPrint();</script>
<script src="scripts/polyfill.js"></script>
<script src="scripts/linenumber.js"></script>

<script src="scripts/search.js" defer></script>



</body>
</html>