<!DOCTYPE html>
<html lang="en">
<head>
    
    <meta charset="utf-8">
    <title>Home - Documentation</title>
    
    
    <script src="scripts/prettify/prettify.js"></script>
    <script src="scripts/prettify/lang-css.js"></script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <link type="text/css" rel="stylesheet" href="styles/prettify.css">
    <link type="text/css" rel="stylesheet" href="styles/jsdoc.css">
    <script src="scripts/nav.js" defer></script>
    
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
</head>
<body>

<input type="checkbox" id="nav-trigger" class="nav-trigger" />
<label for="nav-trigger" class="navicon-button x">
  <div class="navicon"></div>
</label>

<label for="nav-trigger" class="overlay"></label>

<nav >
    
    <input type="text" id="nav-search" placeholder="Search" />
    
    
    <h2><a href="index.html">Home</a></h2><h3>Namespaces</h3><ul><li><a href="itemutils.html">itemutils</a><ul class='methods'><li data-type='method'><a href="itemutils.html#.dimmer">dimmer</a></li><li data-type='method'><a href="itemutils.html#.getGroup">getGroup</a></li><li data-type='method'><a href="itemutils.html#.getRoofwindowOpenLevel">getRoofwindowOpenLevel</a></li></ul></li><li><a href="rulesx.html">rulesx</a><ul class='methods'><li data-type='method'><a href="rulesx.html#.createAlarmClockItems">createAlarmClockItems</a></li><li data-type='method'><a href="rulesx.html#.getAlarmClock">getAlarmClock</a></li><li data-type='method'><a href="rulesx.html#.getClockRule">getClockRule</a></li><li data-type='method'><a href="rulesx.html#.getSceneEngine">getSceneEngine</a></li></ul></li><li><a href="rulesx.alerting.html">alerting</a><ul class='methods'><li data-type='method'><a href="rulesx.alerting.html#.getFrostalarmRule">getFrostalarmRule</a></li><li data-type='method'><a href="rulesx.alerting.html#.getHeatalarmRule">getHeatalarmRule</a></li><li data-type='method'><a href="rulesx.alerting.html#.getRainalarmRule">getRainalarmRule</a></li></ul></li><li><a href="thingsx.html">thingsx</a></li></ul><h3>Classes</h3><ul><li><a href="itemutils.GroupUtils.html">GroupUtils</a><ul class='methods'><li data-type='method'><a href="itemutils.GroupUtils.html#descendentsCount">descendentsCount</a></li><li data-type='method'><a href="itemutils.GroupUtils.html#membersCount">membersCount</a></li></ul></li><li><a href="rulesx.SceneEngine.html">SceneEngine</a><ul class='methods'><li data-type='method'><a href="rulesx.SceneEngine.html#getRule">getRule</a></li></ul></li><li><a href="rulesx.alerting.HeatFrostalarm.html">HeatFrostalarm</a><ul class='methods'><li data-type='method'><a href="rulesx.alerting.HeatFrostalarm.html#checkAlarm">checkAlarm</a></li></ul></li><li><a href="rulesx.alerting.Rainalarm.html">Rainalarm</a><ul class='methods'><li data-type='method'><a href="rulesx.alerting.Rainalarm.html#checkAlarm">checkAlarm</a></li></ul></li><li><a href="thingsx.MlscRestClient.html">MlscRestClient</a><ul class='methods'><li data-type='method'><a href="thingsx.MlscRestClient.html#createCommandHandlingRule">createCommandHandlingRule</a></li><li data-type='method'><a href="thingsx.MlscRestClient.html#scheduleStateFetching">scheduleStateFetching</a></li></ul></li></ul>
    
</nav>

<div id="main">
    

    



    


    <section class="package">
        <h3>@hotzware/openhab-tools 2.2.1</h3>		
    </section>









    



    <section class="readme usertext">
        <article><h1>openHAB JS Automation Tools</h1>
<p>This library provides some utilites for the openHAB JS Scripting Add-On.</p>
<p>The JavaScript Add-On is using the NodeJS version found in <a href="https://github.com/openhab/openhab-addons/blob/main/bundles/org.openhab.automation.jsscripting/pom.xml#L53">openhab/openhab-addons/bundles/org.openhab.automation.jsscripting/pom.xml</a> (currently v16.17.1).</p>
<p>Please note that it depends on the <a href="https://github.com/openhab/openhab-js">openHAB JavaScript Library</a>, which is included in the JS Scripting Add-On by default.
Therefore, it is only listed in the devDependencies of this package.</p>
<p><a href="https://github.com/standard/semistandard"><img src="https://img.shields.io/badge/code%20style-semistandard-brightgreen.svg" alt="js-semistandard-style"></a>
<a href="https://badge.fury.io/js/@hotzware%2Fopenhab-tools"><img src="https://badge.fury.io/js/@hotzware%2Fopenhab-tools.svg" alt="npm version"></a></p>
<h2>Installation</h2>
<ul>
<li>Requires the openHAB <a href="https://www.openhab.org/addons/automation/jsscripting/">JavaScript binding</a> which comes with a version of the <a href="https://www.npmjs.com/package/openhab">openHAB
library</a>.</li>
<li>Go to the javascript user scripts directory: <code>cd $OPENHAB_CONF/automation/js</code></li>
<li>Run <code>npm install @hotzware/openhab-tools</code> (you may need to install npm)</li>
</ul>
<h2>Compatibility</h2>
<p>This library depends on <code>openhab</code> &gt;= 3.1.0 (which is included since openHAB 3.4.x) and <code>openhab_rules_tools</code> &gt;= 2.0.1.</p>
<h2>Scene Engine</h2>
<p>Call scene by sending a command to the <code>sceneItem</code>.</p>
<p>When a member of the scene changes it's state, the rule will check whether a
defined scene is matching the current states and which scene.</p>
<p>It creates a full rule with triggers and actions out of your scene definition.</p>
<h3>The <code>sceneItem</code></h3>
<p>Must be a Number item.
You can assign a scene to every positive integer value,
except to 0.</p>
<p>0 is the value the Item gets when no match with a scene is found on members change.</p>
<h3>Scene definition</h3>
<p>Scene defintion works with an array of objects.</p>
<pre class="prettyprint source lang-javascript"><code>const sceneDefinition = {
  controller: 'scene call item name',
  scenes: [ // For each numeric state of the controller Item one object.
    { // Object for the value 1 of the controller Item.
      value: 1,
      targets: [ // Target states of items in the scene. Parameters explained later.
        { item: 'Florian_Licht', value: 'ON', required: true, conditionFn: function() { return parseFloat(items.getItem('Helligkeit').state) >= 10000; } },
        { item: 'Florian_LED_Stripes', value: 'OFF', required: false }
      ] 
    },
    { // Object for the value 15 of the controller Item.
      value: 15,
      targets: [ // Target states of items in the scene. Parameters explained later.
        { item: 'Florian_LED_Stripes', value: 'ON', required: true }
      ]
    }
  ]
};
</code></pre>
<p>See <a href="https://florian-h05.github.io/openhab-js-tools/rulesx.html#.getSceneEngine">JSDoc: getSceneEngine()</a> for full API documentation.</p>
<h3>Scene rule</h3>
<pre class="prettyprint source lang-javascript"><code>rulesx.getSceneEngine(sceneDefinition);
</code></pre>
<h2>Alarm Clock</h2>
<p>Provides an alarm clock that is configured via Items.</p>
<p>Under the hood, two rules are created. The first rule, so called manager rule, watches for configuration changes and updates the cron trigger of the second rule, the alarm clock itself.
It also disables and enables the alarm clock rule based on the <em>switchItem</em>.</p>
<h3>Required Items</h3>
<p>Configuration Items must follow a specific naming scheme, <em>switchItem</em> can be anything.</p>
<table>
<thead>
<tr>
<th>Itemname-Suffix</th>
<th>Purpose</th>
</tr>
</thead>
<tbody>
<tr>
<td><em>switchItem</em></td>
<td>Enable/disable alarm</td>
</tr>
<tr>
<td><em>switchItem</em><code>_H</code></td>
<td>Hour</td>
</tr>
<tr>
<td><em>switchItem</em><code>_M</code></td>
<td>Minute</td>
</tr>
<tr>
<td><em>switchItem</em><code>_MON</code></td>
<td>Monday</td>
</tr>
<tr>
<td><em>switchItem</em><code>_TUE</code></td>
<td>Tuesday</td>
</tr>
<tr>
<td><em>switchItem</em><code>_WED</code></td>
<td>Wednesday</td>
</tr>
<tr>
<td><em>switchItem</em><code>_THU</code></td>
<td>Thursday</td>
</tr>
<tr>
<td><em>switchItem</em><code>_FRI</code></td>
<td>Friday</td>
</tr>
<tr>
<td><em>switchItem</em><code>_SAT</code></td>
<td>Saturday</td>
</tr>
<tr>
<td><em>switchItem</em><code>_SUN</code></td>
<td>Sunday</td>
</tr>
<tr>
<td><em>switchItem</em><code>_Time</code></td>
<td>Displays the alarm time as String.</td>
</tr>
</tbody>
</table>
<h3>Alarm Rule</h3>
<pre class="prettyprint source lang-javascript"><code>rulesx.getAlarmClock(switchItem, data => { console.log('Successfully tested alarm clock.'); });
</code></pre>
<p>See <a href="https://florian-h05.github.io/openhab-js-tools/rulesx.html#.getAlarmClock">JSDoc: getAlarmClock()</a> for full API documentation.</p>
<hr>
<h2>Group Utilities</h2>
<p>The Group Utilities provide a number of functions on groups, e.g. arithmetic operations like min/max and count operations.</p>
<h3>Examples</h3>
<pre class="prettyprint source lang-javascript"><code>const { itemutils } = require('@hotzware/openhab-tools');
// The name of the member with the maximum state.
itemutils.getGroup(group).membersMax.name;
// The sum of states.
itemutils.getGroup(group).membersSum;
// Count how many members are on.
itemutils.getGroup(group).membersCount(item => item.state === 'ON');
</code></pre>
<p>See <a href="https://florian-h05.github.io/openhab-js-tools/itemutils.GroupUtils.html">JSDoc: GroupUtils</a> for full API documentation.</p>
<h2>Item Dimmer</h2>
<p>The Item Dimmer allows you to dim a given item step-by-step to a target state.
Dimming step size and time between steps are configurable.</p>
<p>The dimmer uses the cache to avoid that multiple dimmers are running on the same Item at same time.
Therefore, it is recommended to use the same <code>managerID</code> in UI based scripts.</p>
<p>Only for file based scripts: To avoid that the dimmer manager crashes due to file reload during dimming process, use the <a href="https://github.com/openhab/openhab-js#scriptunloaded"><code>scriptUnloaded</code></a> function to clear the cache.
You may use multiple <code>managerID</code>s to not cancel all dimmers when one script reloads.</p>
<pre class="prettyprint source lang-javascript"><code>var MANAGER_KEY = 'managerID';
itemutils.dimmer(MANAGER_KEY, targetItem, targetState, step, time, ignoreExternalChange);

// Only for file based scripts:
scriptUnloaded = function () {
  cache.remove(MANAGER_KEY);
};
</code></pre>
<p>See <a href="https://florian-h05.github.io/openhab-js-tools/itemutils.html#.dimmer">JSDoc: dimmer()</a> for full API documentation.</p>
<h3>Example</h3>
<pre class="prettyprint source lang-javascript"><code>itemutils.dimmer('sampleManager', 'Kitchen_Lights', 100, 1, 1000);
</code></pre>
<p>This dims the kitchen light to 100% with steps of 1% each second.</p>
<h2>music_led_strip_control REST client</h2>
<p>The <code>thingsx.MlscRestClientClass</code> enables openHAB to control effect and color of a RGB stripe connected to <a href="https://github.com/TobKra96/music_led_strip_control">music_led_strip_control</a>.</p>
<p>See <a href="https://florian-h05.github.io/openhab-js-tools/thingsx.MlscRestClient.html">JSDoc: MlscRestClient</a> for full API documentation.</p></article>
    </section>






    
    
</div>

<br class="clear">

<footer>
    Documentation generated by <a href="https://github.com/jsdoc3/jsdoc">JSDoc 4.0.2</a> on Sat Mar 11 2023 20:13:30 GMT+0000 (Coordinated Universal Time) using the <a href="https://github.com/clenemt/docdash">docdash</a> theme.
</footer>

<script>prettyPrint();</script>
<script src="scripts/polyfill.js"></script>
<script src="scripts/linenumber.js"></script>

<script src="scripts/search.js" defer></script>



</body>
</html>